# Django-проект CS101 — введение для новичка

Краткое введение в Django и этот проект. Без углубления в детали — только чтобы понять общую картину.

---

## Что такое Django

**Django** — это веб-фреймворк на Python. Он даёт готовые решения для типичных задач сайта: база данных, авторизация, админка, шаблоны страниц, маршруты URL.

Основные идеи:
- **MVT**: Model (модели данных), View (логика/представление), Template (HTML-шаблоны).
- **Конфигурация в коде**: настройки проекта в `settings.py`, маршруты в `urls.py`.
- **ORM**: работа с БД через Python-классы, без написания SQL вручную (хотя SQL при желании можно).

---

## Структура этого проекта

```
django_app/
├── manage.py           # Точка входа: запуск сервера, миграции, создание суперпользователя
├── config/             # Настройки проекта (не путать с «приложением» Django)
│   ├── settings.py     # Вся конфигурация: БД, приложения, шаблоны, безопасность
│   ├── urls.py        # Маршрутизация: какой URL ведёт на какую страницу/вид
│   └── wsgi.py        # Для деплоя на продакшн-сервер (пока можно не трогать)
├── templates/          # HTML-шаблоны (общие для проекта)
│   ├── home.html      # Главная страница
│   └── registration/
│       └── login.html # Страница входа (встроенная авторизация Django)
├── venv/               # Виртуальное окружение Python (зависимости проекта)
├── create_db.sql      # Скрипт создания БД и пользователя PostgreSQL
├── setup_pg_hba.sh    # Разрешение подключения к PostgreSQL по сети (один раз)
└── requirements.txt   # Список пакетов (Django, psycopg2-binary)
```

- **config** — это «проект» (project): общие настройки и корневые URL.
- **Приложения** (apps) — это части функциональности (например, `auth`, `admin`). Здесь мы используем встроенные приложения Django, своих пока нет.
- **templates** — папка с HTML. Django подставляет в шаблоны переменные (`{{ user }}`, `{{ form }}`) и выполняет простую логику (`{% if %}`, `{% url %}`).

---

## Как работает запрос (упрощённо)

1. Пользователь открывает, например, `http://сайт/accounts/login/`.
2. Django смотрит в **urls.py**: этот путь отдан приложению `django.contrib.auth.urls` (встроенный вход/выход).
3. Отображается шаблон **templates/registration/login.html**, в него передаётся форма `form` и переменная `next`.
4. Пользователь вводит логин/пароль и отправляет форму.
5. Django проверяет данные, создаёт сессию и перенаправляет на главную (или на `next`). На главной в шаблоне **home.html** доступна переменная `user` — по ней видно, вошёл ли пользователь.

То есть: **URL → urls.py → view (логика) → шаблон (HTML)**. Данные пользователей и сессий хранятся в PostgreSQL.

---

## База данных (PostgreSQL)

- В **settings.py** указаны имя БД (`cs101_db`), пользователь (`cs101_owner`) и пароль.
- Таблицы создаёт Django командами **миграции** (`python manage.py migrate`). Модели описаны во встроенных приложениях (`auth`, `admin`, `sessions` и т.д.).
- Базу и пользователя один раз создают скриптом **create_db.sql** (от имени суперпользователя PostgreSQL). Скрипт **setup_pg_hba.sh** нужен, чтобы разрешить подключение с этого сервера (127.0.0.1).

Подробности — в комментариях в `config/settings.py` и в начале `create_db.sql` / `setup_pg_hba.sh`.

---

## Что сделать в первую очередь

1. **Активировать виртуальное окружение** (из папки `django_app`):
   ```bash
   source venv/bin/activate
   ```
2. **Создать суперпользователя** (логин/пароль для входа и для админки):
   ```bash
   python manage.py createsuperuser
   ```
3. **Запустить сервер**:
   ```bash
   python manage.py runserver 0.0.0.0:7777
   ```
   Тогда сайт будет доступен, например, по `http://zere.shop:7777/`.
4. Открыть в браузере:
   - `/` — главная (вход/выход);
   - `/accounts/login/` — страница входа;
   - `/admin/` — админ-панель Django (вход под суперпользователем).

---

## Полезные команды

| Команда | Назначение |
|--------|------------|
| `python manage.py runserver [порт]` | Запуск сервера для разработки |
| `python manage.py migrate` | Применить миграции (создать/обновить таблицы в БД) |
| `python manage.py createsuperuser` | Создать учётную запись администратора |
| `python manage.py check` | Проверить настройки проекта на ошибки |

---

## Дальше

- Добавить своё приложение: `python manage.py startapp имя_приложения`, прописать его в `INSTALLED_APPS` и привязать URL в `config/urls.py`.
- Официальная документация: [docs.djangoproject.com](https://docs.djangoproject.com/).
- Русскоязычный учебник: [djbook.ru](https://djbook.ru/).

Комментарии в коде (в `config/settings.py`, `config/urls.py`, шаблонах и скриптах) помечены по-русски и поясняют, за что отвечает каждый блок.
